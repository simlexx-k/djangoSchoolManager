{% extends 'admin/base.html' %}

{% block content %}
<h1 class="text-2xl font-bold mb-4">Generate Progress Report</h1>
<h2 class="text-xl mb-4">{{ learner.name }} - {{ exam_type.name }}</h2>

<form method="post" class="bg-white p-6 rounded shadow">
    {% csrf_token %}
    {{ form.non_field_errors }}
    {% for field in form %}
        <div class="mb-4">
            <label for="{{ field.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">
                {{ field.label }}
            </label>
            {{ field }}
            {% if field.errors %}
                {% for error in field.errors %}
                    <p class="text-red-500 text-xs italic">{{ error }}</p>
                {% endfor %}
            {% endif %}
        </div>
    {% endfor %}
    <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
        Generate Report
    </button>
</form>

<div class="mt-8">
    <h3 class="text-lg font-semibold mb-2">Exam Results</h3>
    <table class="w-full bg-white rounded shadow">
        <thead>
            <tr class="bg-gray-100">
                <th class="p-2 text-left">Subject</th>
                <th class="p-2 text-left">Score</th>
                <th class="p-2 text-left">Grade</th>
            </tr>
        </thead>
        <tbody>
            {% for result in exam_results %}
            <tr>
                <td class="p-2">{{ result.subject.name }}</td>
                <td class="p-2">{{ result.score }}</td>
                <td class="p-2">{{ result.get_grade }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="3" class="p-2 text-center text-gray-500">No exam results available</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div class="mt-8">
    <h3 class="text-lg font-semibold mb-2">Skills Assessments</h3>
    <ul class="bg-white rounded shadow divide-y">
        {% for assessment in skills_assessments %}
        <li class="p-2">
            <span class="font-medium">{{ assessment.skill }}</span>: {{ assessment.get_rating_display }}
        </li>
        {% empty %}
        <li class="p-2 text-center text-gray-500">No skills assessments available</li>
        {% endfor %}
    </ul>
</div>

<div class="mt-8">
    <h3 class="text-lg font-semibold mb-2">Behavioral Assessments</h3>
    <ul class="bg-white rounded shadow divide-y">
        {% for assessment in behavioral_assessments %}
        <li class="p-2">
            <span class="font-medium">{{ assessment.category }}</span>: {{ assessment.get_rating_display }}
            <p class="text-sm text-gray-600">{{ assessment.comment }}</p>
        </li>
        {% empty %}
        <li class="p-2 text-center text-gray-500">No behavioral assessments available</li>
        {% endfor %}
    </ul>
</div>

{% endblock %}